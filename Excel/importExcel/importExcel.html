<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>SheetJS JS-XLSX AJAX Live Demo</title>
</head>
<body>
<input type="file" id="FileExcel">
<button id="import" onclick="importExcel('FileExcel',importCollback)">import</button>
<br>
<!-- <script src="./jszip.js"></script> -->
<!-- <script src="./xlsx.js"></script> -->
<script src="importExcal.min.js"></script>

<script>
    function importCollback(data){
        console.log("collback");
        console.log(data);
    }
    // function importExcel(id,importCollback){
    //     this._this = this;
    //     this.handleFile = function(id,importCollback){
    //         // var files = $('#' + id).get(0).files;
    //         var files = document.getElementById(id).files;
    //         var i,f;
    //          for (i = 0; i != files.length; ++i) {
    //             f = files[i];
    //             var reader = new FileReader();
    //             var name = f.name;
    //               var a = reader.onload = function(e) {
    //                 var data = e.target.result;
    //                 var workbook;
    //                 workbook = XLSX.read(data, {type: 'binary'});
    //                   _this.process_wb(workbook,importCollback)
    //                 /* DO SOMETHING WITH workbook HERE */
    //             };
    //             reader.readAsBinaryString(f);
    //         }
    //     };
    //     this.process_wb = function(wb,importCollback){
    //         var output = JSON.stringify(this.to_json(wb), 2, 2);
    //         importCollback(output)
    //     }
    //     this.to_json = function(workbook){
    //         var result = {};
    //         workbook.SheetNames.forEach(function(sheetName) {
    //             var roa = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
    //             if(roa.length > 0){
    //                 result[sheetName] = roa;
    //             }
    //         });
    //         return result;
    //     }
    //      this.handleFile(id,importCollback);
    // }


</script>
</body></html>